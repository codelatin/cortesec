<!-- templates/proyectos/project_form.html -->
{% extends 'core/base_dashboard.html' %}

{% block title %}{{ title }} - Corte-Sec{% endblock %}
{% block page_title %}{{ title }}{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-12">
    <div class="card card-primary">
      <div class="card-header">
        <h3 class="card-title">{{ title }}</h3>
      </div>
      
      <form method="post">
        {% csrf_token %}
        <div class="card-body">
          
          <!-- Información Básica -->
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="{{ form.name.id_for_label }}">Nombre de la Obra *</label>
                {{ form.name }}
                {% if form.name.errors %}
                  <div class="text-danger">{{ form.name.errors }}</div>
                {% endif %}
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="{{ form.code.id_for_label }}">Código *</label>
                {{ form.code }}
                {% if form.code.errors %}
                  <div class="text-danger">{{ form.code.errors }}</div>
                {% endif %}
              </div>
            </div>
          </div>

          <div class="form-group">
            <label for="{{ form.description.id_for_label }}">Descripción</label>
            {{ form.description }}
            {% if form.description.errors %}
              <div class="text-danger">{{ form.description.errors }}</div>
            {% endif %}
          </div>

          <div class="form-group">
            <label for="{{ form.location.id_for_label }}">Ubicación *</label>
            {{ form.location }}
            {% if form.location.errors %}
              <div class="text-danger">{{ form.location.errors }}</div>
            {% endif %}
          </div>

          <!-- Cliente -->
          <h5 class="mt-4">Cliente</h5>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="{{ form.client_name.id_for_label }}">Nombre del Cliente *</label>
                {{ form.client_name }}
                {% if form.client_name.errors %}
                  <div class="text-danger">{{ form.client_name.errors }}</div>
                {% endif %}
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="{{ form.client_company.id_for_label }}">Empresa del Cliente</label>
                {{ form.client_company }}
                {% if form.client_company.errors %}
                  <div class="text-danger">{{ form.client_company.errors }}</div>
                {% endif %}
              </div>
            </div>
          </div>

          <!-- Fechas -->
          <h5 class="mt-4">Fechas</h5>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="{{ form.start_date.id_for_label }}">Fecha de Inicio *</label>
                {{ form.start_date }}
                {% if form.start_date.errors %}
                  <div class="text-danger">{{ form.start_date.errors }}</div>
                {% endif %}
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="{{ form.end_date.id_for_label }}">Fecha de Finalización *</label>
                {{ form.end_date }}
                {% if form.end_date.errors %}
                  <div class="text-danger">{{ form.end_date.errors }}</div>
                {% endif %}
              </div>
            </div>
          </div>

          <!-- Finanzas -->
          <h5 class="mt-4">Información Financiera</h5>
          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <label for="{{ form.contract_amount.id_for_label }}">Monto del Contrato *</label>
                {{ form.contract_amount }}
                {% if form.contract_amount.errors %}
                  <div class="text-danger">{{ form.contract_amount.errors }}</div>
                {% endif %}
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label for="{{ form.budget.id_for_label }}">Presupuesto Asignado *</label>
                {{ form.budget }}
                {% if form.budget.errors %}
                  <div class="text-danger">{{ form.budget.errors }}</div>
                {% endif %}
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label for="{{ form.contract_type.id_for_label }}">Tipo de Contrato *</label>
                {{ form.contract_type }}
                {% if form.contract_type.errors %}
                  <div class="text-danger">{{ form.contract_type.errors }}</div>
                {% endif %}
              </div>
            </div>
          </div>

          <!-- Gestión -->
          <h5 class="mt-4">Gestión</h5>
          <div class="row">
            <div class="col-md-4">
              <div class="form-group">
                <label for="{{ form.status.id_for_label }}">Estado *</label>
                {{ form.status }}
                {% if form.status.errors %}
                  <div class="text-danger">{{ form.status.errors }}</div>
                {% endif %}
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label for="{{ form.progress.id_for_label }}">Progreso (%) *</label>
                {{ form.progress }}
                {% if form.progress.errors %}
                  <div class="text-danger">{{ form.progress.errors }}</div>
                {% endif %}
              </div>
            </div>
            <div class="col-md-4">
              <div class="form-group">
                <label for="{{ form.project_manager.id_for_label }}">Gerente de Obra</label>
                {{ form.project_manager }}
                {% if form.project_manager.errors %}
                  <div class="text-danger">{{ form.project_manager.errors }}</div>
                {% endif %}
              </div>
            </div>
          </div>

        </div>
        <div class="card-footer">
          <button type="submit" class="btn btn-primary">{{ title }}</button>
          <a href="{% url 'proyectos:project_list' %}" class="btn btn-default">Cancelar</a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}